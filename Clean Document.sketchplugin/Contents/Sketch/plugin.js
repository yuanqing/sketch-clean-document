!function(e,t){for(var n in t)e[n]=t[n]}(this,function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}([function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"CHECK_BOX",function(){return h}),n.d(r,"DROP_DOWN",function(){return O}),n.d(r,"RADIO_BUTTONS",function(){return _}),n.d(r,"NUMERIC_TEXT_BOX",function(){return k.a}),n.d(r,"STRING_TEXT_BOX",function(){return x}),n.d(r,"TEXT_BOX",function(){});var o=n(1);function s(e){const t={};return function e(t,n,r){Object.keys(t).forEach(function(o){const s=[n,o].filter(Boolean).join("."),c=t[o];"object"!=typeof c||null===c||Array.isArray(c)?r[s]=t[o]:e(c,s,r)})}(e,null,t),t}const c=/\./;function a(e){const t={};return Object.keys(e).forEach(function(n){!function e(t,n,r){const o=t[0];if(1===t.length)return void(r[o]=n);null==r[o]&&(r[o]={});e(t.slice(1),n,r[o])}(n.split(c),e[n],t)}),t}function i(){const e={cleanLayers:{deleteHiddenLayers:!0,smartRenameLayers:!0,smartSortLayers:!0,unnestNestedGroups:!0,whitelistRegularExpression:""},cleanPages:{deleteEmptyPages:!0,sortPages:!0},cleanStyles:{deleteUnusedLayerStyles:!0,deleteUnusedTextStyles:!0},cleanSymbols:{deleteUnusedSymbols:!0,organiseSymbols:!0,groupDefinition:"2nd",space:100}};if(!e)return{};const t={},n=s(e);return Object.keys(n).forEach(function(e){const r=Object(o.sessionVariable)(e),s=Object(o.settingForKey)(e),c=void 0!==r?r:s,a=n[e];t[e]=void 0!==c?c:a}),a(t)}const u=1,l=10,f=17;const d=2,y=20,b=2;const p=20,m=10;function h({width:e,y:t,label:n,value:r}){const o=NSButton.alloc().initWithFrame(NSMakeRect(0,t,e,p));return o.setButtonType(NSSwitchButton),o.setBezelStyle(0),o.setState(r?NSOnState:NSOffState),o.setTitle(n),{view:o,height:p+m,retrieveValue:function(){return"1"==o.stringValue()}}}const g=20,S=15;function O({width:e,y:t,value:n,possibleValues:r}){const o=NSPopUpButton.alloc().initWithFrame(NSMakeRect(0,t,e,g));r.forEach(function(e){o.addItemWithTitle(`${e}`)});const s=void 0!==n?r.indexOf(n):0;return o.selectItemAtIndex(s),{view:o,height:g+S,retrieveValue:function(){const e=o.indexOfSelectedItem();return r[e]}}}const v=20,j=10;function _({width:e,y:t,value:n,possibleValues:r}){const o=NSButtonCell.alloc().init();o.setButtonType(NSRadioButton);const s=r.length,c=NSMatrix.alloc().initWithFrame_mode_prototype_numberOfRows_numberOfColumns(NSMakeRect(0,t,e,v),NSRadioModeMatrix,o,1,s);c.setCellSize(CGSizeMake(Math.floor(e/s),v)),c.cells().forEach(function(e,t){e.setTitle(r[t])});const a=void 0!==n?r.indexOf(n):0;return c.selectCellAtRow_column(0,a),{view:c,height:v+j,retrieveValue:function(){const e=c.cells().indexOfObject(c.selectedCell());return r[e]}}}var k=n(13),w=n(7);const x=Object(w.a)(),L=300;function E({title:e,inputs:t}){const n=s(i()),{formView:o,retrieveValues:c}=function({inputsConfig:e,settings:t}){const n=NSView.alloc().init();n.setFlipped(!0);const o={};let s=0;e.forEach(function(e){if("-"===e){const{view:e,height:t}=function({width:e,y:t}){const n=NSView.alloc().initWithFrame(NSMakeRect(0,t+l,e,u));return n.setWantsLayer(1),n.layer().setBackgroundColor(CGColorCreateGenericRGB(127/255,127/255,127/255,.5)),{view:n,height:l+u+f}}({width:L,y:s});return s+=t,void n.addSubview(e)}const{type:c,key:a,label:i,value:p,...m}=e;if(i&&"CHECK_BOX"!==c){const{view:e,height:t}=function({width:e,y:t,label:n}){const r=NSTextField.alloc().initWithFrame(NSMakeRect(0,t+d,e,y));return r.setBezeled(!1),r.setDrawsBackground(!1),r.setEditable(!1),r.setLineBreakMode(NSLineBreakByTruncatingTail),r.setSelectable(!1),r.setStringValue(n),{view:r,height:d+y+b}}({width:L,y:s,label:i});s+=t,n.addSubview(e)}const h=t[a],g=null!=p?p:h,{view:S,height:O,retrieveValue:v}=r[c]({width:L,y:s,label:i,value:g,...m});s+=O,n.addSubview(S),o[a]=v});const c=n.subviews();return c.forEach(function(e,t){t<c.length-1&&e.setNextKeyView(c[t+1])}),n.setFrame(NSMakeRect(0,0,L,s)),{formView:n,retrieveValues:o}}({inputsConfig:t.filter(Boolean),settings:n}),p=function(e){const t=NSAlert.alloc().init();return t.setMessageText(e),t.addButtonWithTitle("OK"),t.addButtonWithTitle("Cancel"),t}(e);p.setAccessoryView(o);const m=o.subviews();if(m[0]&&p.window().setInitialFirstResponder(m[0]),"1000"==p.runModal()){const e={};return Object.keys(c).forEach(function(t){const n=c[t];e[t]=n()}),a(e)}return null}var N=n(14),T=n.n(N);function C(e,t){T.a.message(t&&t.symbol?`${t.symbol} ${e}`:e)}function D(e){C(e,{symbol:"✔"})}function P(e){C(e,{symbol:"✘"})}function M(){const e={cleanLayers:{deleteHiddenLayers:!0,smartRenameLayers:!0,smartSortLayers:!0,unnestNestedGroups:!0,whitelistRegularExpression:""},cleanPages:{deleteEmptyPages:!0,sortPages:!0},cleanStyles:{deleteUnusedLayerStyles:!0,deleteUnusedTextStyles:!0},cleanSymbols:{deleteUnusedSymbols:!0,organiseSymbols:!0,groupDefinition:"2nd",space:100}};if(!e)return;const t=s(e);Object.keys(t).forEach(function(e){Object(o.setSettingForKey)(e,void 0),Object(o.setSessionVariable)(e,void 0)}),C("Reset settings")}const R=B(o.setSettingForKey);B(o.setSessionVariable);function B(e){return function(t,n){if(!t)return;const r=s(t);Object.keys(r).forEach(function(t){const n=r[t];null!=n&&e(t,n)});const o=n&&n.successMessage;o&&C(o)}}n(15),n(16);var V=n(4);var I=n(6);function U(){const e=NSApplication.sharedApplication().orderedDocuments();return Object(I.fromNative)(e[0])}function F(e){!function e(t,n){const r=t.parent;r&&"Group"===r.type&&!n[r.id]&&(r.adjustToFit(),n[r.id]=!0,e(r,n))}(e,{})}function G(){return U().pages}function A(){return V.Page.getSymbolsPage(U())}function W(){return U().selectedPage.layers}function X(){const e=[];return G().forEach(function({layers:t}){t.forEach(function(t){e.push(t)})}),e}function $(){return U().selectedLayers.layers.reverse()}function q(){const e=$();return 0!==e.length?e:W()}function H(e,t){e.forEach(function(e){t(e);const n=e.type;"Artboard"!==n&&"Group"!==n||H(e.layers,t)})}n.d(t,"k",function(){return i}),n.d(t,"n",function(){return E}),n.d(t,"o",function(){return M}),n.d(t,"p",function(){return R}),n.d(t,"a",function(){return"CHECK_BOX"}),n.d(t,"b",function(){return"DROP_DOWN"}),n.d(t,"c",function(){return"NUMERIC_TEXT_BOX"}),n.d(t,"d",function(){return"STRING_TEXT_BOX"}),n.d(t,"e",function(){return F}),n.d(t,"g",function(){return U}),n.d(t,"f",function(){return G}),n.d(t,"l",function(){return A}),n.d(t,"h",function(){return X}),n.d(t,"i",function(){return $}),n.d(t,"j",function(){return q}),n.d(t,"m",function(){return H}),n.d(t,"r",function(){return C}),n.d(t,"s",function(){return D}),n.d(t,"q",function(){return P})},function(e,t){e.exports=require("sketch/settings")},function(e,t,n){"use strict";function r(e){return Object.keys(e).reduce(function(t,n){return t||(!!e[n]||void 0)},!1)}n.d(t,"a",function(){return r})},function(e,t){var n=function(e,t){var n,r,o=1,s=0,c=0,a=String.alphabet;function i(e,t,r){if(r){for(n=t;(r=i(e,n))<76&&r>65;)++n;return+e.slice(t-1,n)}return(r=a&&a.indexOf(e.charAt(t)))>-1?r+76:(r=e.charCodeAt(t)||0)<45||r>127?r:r<46?65:r<48?r-1:r<58?r+18:r<65?r-11:r<91?r+11:r<97?r-37:r<123?r+5:r-63}if((e+="")!=(t+=""))for(;o;)if(r=i(e,s++),o=i(t,c++),r<76&&o<76&&r>66&&o>66&&(r=i(e,s,s),o=i(t,c,s=n),c=n),r!=o)return r<o?-1:1;return 0};try{e.exports=n}catch(e){String.naturalCompare=n}},function(e,t){e.exports=require("sketch/dom")},function(e,t,n){"use strict";function r({sortedLayers:e,shouldSelectLayers:t}){const n=e[0],r=n.sketchObject.parentGroup(),o=MSLayer.alloc().init();r.insertLayer_beforeLayer(o,n.sketchObject),e.reverse().forEach(function(e){e.sketchObject.moveToLayer_beforeLayer(r,o),e.selected=t}),o.removeFromParent()}n.d(t,"a",function(){return r})},function(e,t){e.exports=require("sketch")},function(e,t,n){"use strict";n.d(t,"a",function(){return s});const r=20,o=15;function s(e){return function({width:t,y:n,value:s,placeholder:c}){const a=NSTextField.alloc().initWithFrame(NSMakeRect(0,n,t,r)),i=null==s?"":`${s}`;return a.setStringValue(i),c&&a.setPlaceholderString(c),{view:a,height:r+o,retrieveValue:function(){const t=`${a.stringValue()}`;return e?e(t):t}}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(5);function s({sortLayers:e,successMessage:t}){return function(){const n=Object(r.i)();if(n.length<2)return void Object(r.q)("Select at least 2 layers");if(!function([e,...t]){const n=e.parent;return t.reduce(function(e,t){if(!e)return e;const r=t.parent;return null==n?null==r:r.id&&r.id===n.id},!0)}(n))return void Object(r.q)("Selected layers are not in the same list");const s=e(n);Object(o.a)({sortedLayers:s,shouldSelectLayers:!0}),Object(r.s)(t)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var r=n(3),o=n.n(r),s=n(6),c=n(0),a=n(2);function i({isCleanDocument:e}){const t=Object(c.k)().cleanPages;if(!Object(a.a)(t))return;let n=0;t.sortPages&&function(){const e=Object(c.g)().sketchObject,t=e.pages(),n=Object(c.l)(),r=n?n.id:null;t.sort(function(e,t){const n=Object(s.fromNative)(e),c=Object(s.fromNative)(t);return n.id===r?1:c.id===r?-1:n.name===c.name?o()(n.id,c.id):o()(n.name.toLowerCase(),c.name.toLowerCase())}),e.performPageSwitchUpdates()}(),t.deleteEmptyPages&&(n=function(){let e=0;return Object(c.f)().forEach(function(t){0===t.layers.length&&(t.remove(),e++)}),e}()),e||(t.deleteEmptyPages&&0!==n?Object(c.s)(`Sorted pages and deleted ${n} empty page${1===n?"":"s"}`):Object(c.s)("Sorted pages"))}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(2);const s={Group:function(e){e.name="Group"},HotSpot:function(e){e.name="Hotspot"},Image:function(e){e.name="Bitmap"},Shape:function(e){e.name="Combined Shape",e.layers.forEach(function(e){c(e)})},ShapePath:function(e){"Rectangle"!==e.shapeType?"Oval"!==e.shapeType?e.name="Path":e.name="Oval":e.name="Rectangle"},SymbolInstance:function(e){const t=Object(r.g)().getSymbolMasterWithID(e.symbolId);e.name=t.name},Text:function(e){const t=e.sketchObject;t.setName(t.stringValue().substring(0,20)),t.setNameIsFixed(!1)}};function c(e){if(0!==e.exportFormats.length)return;if(1===e.sketchObject.hasClippingMask())return void(e.name="Mask");const t=s[e.type];t&&t(e)}function a(e,t){const n=e.frame,r=t.frame,o=n.y-r.y;return 0!==o?o:n.x-r.x}var i=n(8);Object(i.a)({sortLayers:u,successMessage:"Smart sorted layers"});function u([e,...t]){const n=[e];return t.forEach(function(e){let t=n.length;for(;t-- >0;){const r=n[t];if(l(e,r)||a(e,r)>0)return void n.splice(t+1,0,e)}n.splice(0,0,e)}),n}function l(e,t){const n=e.frame,r=t.frame;return!(n.x+n.width<r.x||r.x+r.width<n.x||n.y+n.height<r.y||r.y+r.height<n.y)}var f=n(5);function d({isCleanDocument:e}){const t=Object(r.k)().cleanLayers;if(!Object(o.a)(t))return;const n=e?Object(r.h)():Object(r.j)(),s=t.whitelistRegularExpression,a=""===s?null:new RegExp(s);Object(r.m)(n,function(e){a&&a.test(e.name)||t.deleteHiddenLayers&&function(e){return!!e.hidden&&(e.remove(),!0)}(e)||(t.smartRenameLayers&&c(e),t.smartSortLayers&&function(e){if("Artboard"===e.type||"Group"===e.type){const t=u([...e.layers].reverse());Object(f.a)({sortedLayers:t,shouldSelectLayers:!1})}}(e),t.unnestNestedGroups&&function e(t){if("Group"!==t.type)return;const n=t.layers,o=n.length;if(0===o)return t.remove(),void Object(r.e)(t);if(1===o){const o=t.transform,s=t.style;if(t.hidden||t.locked||0!==t.exportFormats.length||t.flow||0!==o.rotation||o.flippedHorizontally||o.flippedVertically||1!==s.opacity||0!==s.shadows.length)return;return n[0].sketchObject.moveToLayer_beforeLayer(t.parent.sketchObject,t.sketchObject),t.selected=!1,n[0].selected=!1,t.remove(),Object(r.e)(t),void e(n[0])}n.forEach(function(t){e(t)})}(e))}),e||Object(r.s)("Layers cleaned")}n.d(t,"default",function(){return d})},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(2);var s=n(3),c=n.n(s),a=n(4),i=n(8);Object(i.a)({sortLayers:u,successMessage:"Sorted layers by name"});function u(e){return e.sort(function(e,t){const n=e.name.toLowerCase(),r=t.name.toLowerCase();return n===r?c()(e.id,t.id):c()(n,r)})}var l=n(5);function f({groupDefinition:e,space:t}){const n=function(){const e=[];return Object(r.f)().forEach(function(t){t.layers.forEach(function(t){"SymbolMaster"===t.type&&e.push(t)})}),e}();if(0===n.length)return;const o=Object(r.l)()||a.Page.createSymbolsPage();o.sketchObject.setRulerBase(CGPointMake(0,0)),o.name="Symbols",function({symbols:e,symbolsPage:t}){e.forEach(function(e){e.parent.id!==t.id&&(e.sketchObject.moveToLayer_beforeLayer(t.sketchObject,null),e.sketchObject.select_byExpandingSelection(!1,!0))})}({symbols:n,symbolsPage:o});const s=function({symbols:e,groupDefinition:t}){const n={};return e.forEach(function(e){const r=e.name.split(d).slice(0,t).join("/");n[r]||(n[r]={groupName:r,layers:[]}),n[r].layers.push(e)}),Object.values(n).sort(function(e,t){return c()(e.groupName.toLowerCase(),t.groupName.toLowerCase())}).map(function({layers:e}){return u(e)})}({symbols:n,groupDefinition:e});!function({symbolGroups:e,space:t}){let n=0;e.forEach(function(e){let r=0,o=0;e.forEach(function(e){e.frame.x=n,e.frame.y=r,r+=e.frame.height+t,e.frame.width>o&&(o=e.frame.width)}),n+=o+t})}({symbolGroups:s,space:t}),function(e){const t=[];e.forEach(function(e){e.forEach(function(e){t.push(e)})}),Object(l.a)({sortedLayers:t,shouldSelectLayers:!1})}(s)}const d=/\s*\/\s*/;function y({isCleanDocument:e}){const t=Object(r.k)().cleanSymbols;if(!Object(o.a)(t))return;let n=0;if(t.deleteUnusedSymbols&&(n=function(){let e=0;return Object(r.m)(Object(r.h)(),function(t){"SymbolMaster"===t.type&&0===t.getAllInstances().length&&(t.remove(),e++)}),e}()),t.organiseSymbols&&f({groupDefinition:parseInt(t.groupDefinition,10),space:t.space}),!e&&t.deleteUnusedSymbols){if(0===n)return void Object(r.r)("No unused symbols");Object(r.s)(`Deleted ${n} unused symbol${1===n?"":"s"}`)}}n.d(t,"default",function(){return y})},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(2);const s=a("layerStyles","sharedLayerStyles"),c=a("layerTextStyles","sharedTextStyles");function a(e,t){return function(){const n=Object(r.g)(),o=n.sketchObject.documentData()[e]();let s=0;return n[t].forEach(function(e){0===e.getAllInstancesLayers().length&&(o.removeSharedStyle(o.sharedStyleWithID(e.id)),s++)}),s}}function i({isCleanDocument:e}){const t=Object(r.k)().cleanStyles;if(!Object(o.a)(t))return;let n=0;t.deleteUnusedLayerStyles&&(n+=s()),t.deleteUnusedTextStyles&&(n+=c()),e||(0!==n?Object(r.s)(`Deleted ${n} unused style${1===n?"":"s"}`):Object(r.r)("No unused styles"))}n.d(t,"default",function(){return i})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return createNumericTextBox});var _text_box_factory__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7);const createNumericTextBox=Object(_text_box_factory__WEBPACK_IMPORTED_MODULE_0__.a)(function(value){return parseFloat(eval(value))})},function(e,t){e.exports=require("sketch/ui")},function(e,t){e.exports=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}},function(e,t,n){"use strict";const r=async(e,t)=>{let n=0;for(const r of e)await t(await r,n++);return e};e.exports=r,e.exports.default=r},function(e,t,n){e.exports=n(18)},function(e,t,n){e.exports={"clean-document":n(19).default,"clean-layers/clean-layers":n(10).default,"clean-symbols/clean-symbols":n(11).default,"clean-styles/clean-styles":n(12).default,"clean-pages/clean-pages":n(9).default,"settings/settings":n(20).default,"settings/reset-settings":n(21).default}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var r=n(0),o=n(10),s=n(9),c=n(12),a=n(11);function i(){Object(o.default)({isCleanDocument:!0}),Object(a.default)({isCleanDocument:!0}),Object(c.default)({isCleanDocument:!0}),Object(s.default)({isCleanDocument:!0}),Object(r.s)("Document cleaned")}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n(0);const o={title:"Settings for Clean Document",inputs:[{type:r.a,key:"cleanLayers.deleteHiddenLayers",label:"Delete hidden layers"},{type:r.a,key:"cleanLayers.unnestNestedGroups",label:"Unnest nested groups"},{type:r.a,key:"cleanLayers.smartRenameLayers",label:"Smart rename layers"},{type:r.a,key:"cleanLayers.smartSortLayers",label:"Smart sort layers"},{type:r.d,key:"cleanLayers.whitelistRegularExpression",label:"Whitelist regular expression"},"-",{type:r.a,key:"cleanSymbols.deleteUnusedSymbols",label:"Delete unused symbols"},{type:r.a,key:"cleanSymbols.organiseSymbols",label:"Organise symbols"},{type:r.b,key:"cleanSymbols.groupDefinition",label:"Symbol group definition",possibleValues:["1st","2nd","3rd","4th"]},{type:r.c,key:"cleanSymbols.space",label:"Space between symbols"},"-",{type:r.a,key:"cleanStyles.deleteUnusedTextStyles",label:"Delete unused text styles"},{type:r.a,key:"cleanStyles.deleteUnusedLayerStyles",label:"Delete unused layer styles"},"-",{type:r.a,key:"cleanPages.deleteEmptyPages",label:"Delete empty pages"},{type:r.a,key:"cleanPages.sortPages",label:"Sort pages"}]};function s(){const e=Object(r.n)(o);e&&Object(r.p)(e,{successMessage:"Settings saved"})}},function(e,t,n){"use strict";n.r(t);var r=n(0);t.default=r.o}]));